---
globs:
  - "**/*.sh"
description: "Best practices for writing shell scripts."
---

When writing or modifying shell scripts (`.sh`), please follow these guidelines to ensure they are robust and maintainable.

### Best Practices

- **Use `set -euo pipefail`:**
  - `set -e`: Exit immediately if a command exits with a non-zero status.
  - `set -u`: Treat unset variables as an error.
  - `set -o pipefail`: The return value of a pipeline is the status of the last command to exit with a non-zero status, or zero if no command exited with a non-zero status.
- **Quote Variables:** Always quote variables (`"$VAR"`) to prevent word splitting and globbing issues.
- **Use `$(...)` for Command Substitution:** Prefer `$(...)` over backticks `` for command substitution as it's easier to read and can be nested.
- **Check for Command Existence:** Before using a command, check if it exists in the user's `PATH`.

### Example: Good Script Header

```bash:valid
#!/bin/bash
set -euo pipefail

# Check for required command
if ! command -v terraform &> /dev/null; then
    echo "terraform could not be found"
    exit 1
fi

echo "Terraform is installed."
```

### Example: Bad Script Practices

```bash:invalid
#!/bin/sh
# Missing set commands

VAR="some value"
echo $VAR # Unquoted variable

# Backticks for command substitution
DATE=`date`
echo "Today is $DATE"
```
