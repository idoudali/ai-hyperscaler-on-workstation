---
description: "Development environment uses Docker-based container for all build operations. All build commands MUST be executed inside the development container using the provided script."
alwaysApply: true
---

# Cursor Agent Configuration for Pharos AI Hyperscaler Project

## Development Environment
This project uses a Docker-based development container for all build operations.
All build commands MUST be executed inside the development container using the provided script.

## Container Usage
- **Container Script**: `./scripts/run-in-dev-container.sh`
- **Makefile Wrapper**: Use `make run-docker COMMAND="..."` for build commands
- **Interactive Shell**: Use `make shell-docker` or `./scripts/run-in-dev-container.sh`

## Build System Configuration
- **Build System**: CMake with Ninja generator
- **Build Directory**: `build/`
- **Configuration**: Always use `make config` (which runs `cmake -G Ninja -S . -B build`)

## Required Commands for Build Operations

### CMake Configuration
```bash
# Configure CMake with Ninja generator (ALWAYS use this)
make config
```

### Build Commands
```bash
# Build specific targets
make run-docker COMMAND="cmake --build build --target <target-name>"

# Build all targets
make run-docker COMMAND="cmake --build build"

# List available targets
make run-docker COMMAND="cmake --build build --target help"
```

### Packer Image Builds
```bash
# Build specific Packer targets (after CMake configuration)
make run-docker COMMAND="cmake --build build --target <packer-target-name>"

# List available Packer targets
make run-docker COMMAND="cmake --build build --target help"
```

## Important Rules

1. **NEVER run build commands directly on the host** - always use the container
2. **ALWAYS use Ninja generator** - never use Make or other generators
3. **Build directory is always `build/`** - don't use other directories
4. **Use the Makefile wrapper** when possible for consistency
5. **Check container availability** before running commands

## Available Makefile Targets
The following targets are available in the Makefile:
- `make build-docker` - Build the development Docker image
- `make shell-docker` - Start an interactive shell in the container
- `make run-docker COMMAND="..."` - Run a command in the container
- `make config` - Configure CMake with Ninja generator
- `make clean-docker` - Remove Docker images and containers
- `make help` - Show all available targets

## Container Prerequisites
Before running any build commands, ensure:
- Docker is running
- Development image is built: `make build-docker`
- CMake is configured: `make config`

## Common Workflows

### Initial Setup
```bash
# 1. Build the development container
make build-docker

# 2. Configure CMake
make config

# 3. Build a specific target
make run-docker COMMAND="cmake --build build --target <target>"
```

### Development Workflow
```bash
# Enter interactive container for development
make shell-docker

# Or run specific commands
make run-docker COMMAND="your-command-here"
```

## Error Handling
If build commands fail:
1. Check if container is running: `docker ps`
2. Rebuild container if needed: `make build-docker`
3. Reconfigure CMake: `make config`
4. Check build directory exists: `ls -la build/`

## File Permissions
The container automatically handles file permissions and ownership to match the host user.
