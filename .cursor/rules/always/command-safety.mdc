---
alwaysApply: true
---
# Command Execution Safety Policy

## Security Model: Deny-List Approach

- âœ… All commands allowed by default
- âŒ Only explicitly dangerous commands blocked
- âš ï¸ Requires careful monitoring

## ðŸš« Globally Denied Commands

### Privilege Escalation
- `sudo *`, `su *`, `doas *` - Require user approval

### Destructive Operations
- `rm -rf /*`, `rm -rf ~/*`, `rm -rf /home/*`, `/usr/*`, `/etc/*`, `/var/*`, `/opt/*`
- `find * -delete`, `find * -exec rm *`, `shred *`

### Dangerous Permissions
- `chmod 777 *`, `chmod -R 777 *`, `chmod a+w /*`
- `chown -R * /*`

### System Modification
- `mkfs*`, `fdisk *`, `parted *`
- `dd if=* of=/dev/*`
- `mkswap *`, `swapon *`

### Package Management (Require Approval)
- `apt-get remove/purge *`, `apt remove/purge *`
- `yum remove *`, `dnf remove *`, `pacman -R *`

### Service Control (Require Approval)
- `systemctl stop/disable *`, `systemctl poweroff/reboot`
- `shutdown *`, `reboot`, `halt`, `poweroff`

### Force Operations (Require Approval)
- `git push --force*`, `git reset --hard*`, `git clean -fd*`
- `terraform destroy*`, `terraform apply -auto-approve*`
- `docker system prune -a*`, `docker rm -f $(docker ps -aq)`
- `kubectl delete --all*`
- `ansible-playbook * --force*`, `packer build * --force*`

### Security Risks
- `nmap *`, `nc -e *`, `netcat -e *`
- `eval *`, `exec *`
- `history -c`, `history -w`, `> ~/.bash_history`

### Raw Device Access
- `* > /dev/sd*`, `* > /dev/nvme*`

### Process Killing
- `kill -9 1`, `killall -9 *`, `pkill -9 *`

## âœ… All Other Commands Allowed

Permitted commands:
- File operations (ls, cat, grep, find)
- Build tools (make, cmake, ninja, npm, cargo)
- Version control (git status, diff, log, add, commit)
- Development tools (editors, debuggers, profilers)
- Infrastructure tools (terraform plan, ansible-playbook --check)
- Container operations (docker ps, build, run)
- System information (ps, top, df, du)

## Guidelines

1. **Default to Allow** - If not in deny list, command is allowed
2. **Ask for Dangerous Ops** - When in doubt, ask user
3. **Explain Impact** - Explain powerful commands
