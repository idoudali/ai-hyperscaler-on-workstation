---
# BeeGFS Client - Configuration Tasks

- name: Configure BeeGFS client
  ansible.builtin.template:
    src: beegfs-client.conf.j2
    dest: /etc/beegfs/beegfs-client.conf
    owner: root
    group: root
    mode: '0644'
  tags:
    - beegfs
    - beegfs-client
    - configuration

- name: Create BeeGFS client mount preference file
  ansible.builtin.file:
    path: /etc/beegfs/beegfs-client-mount.pref
    state: touch
    owner: root
    group: root
    mode: '0644'
  tags:
    - beegfs
    - beegfs-client
    - configuration

- name: Create BeeGFS authentication file (required even when disabled)
  ansible.builtin.file:
    path: /etc/beegfs/conn.auth
    state: touch
    owner: root
    group: root
    mode: '0600'
  tags:
    - beegfs
    - beegfs-client
    - configuration

# Note: beegfs-setup-client does not exist in BeeGFS 8.1.0+
# Client initialization is handled automatically when mounting

# Note: BeeGFS 8.1.0+ does not include a separate helperd service
# Helper functionality is integrated into the main services

- name: Display configuration status
  ansible.builtin.debug:
    msg: "BeeGFS client configured to mount {{ beegfs_client_mount_point }}"
  tags:
    - beegfs
    - beegfs-client
