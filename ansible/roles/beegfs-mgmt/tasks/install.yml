---
# BeeGFS Management Service - Installation Tasks
# Installs from pre-built packages only (no source build)
# Now uses beegfs-common role for shared package installation logic

- name: Install BeeGFS management service packages via common role
  ansible.builtin.import_role:
    name: beegfs-common
    tasks_from: install-packages
  vars:
    beegfs_service_type: "mgmt"
    beegfs_binary_check_path: "/usr/bin/beegfs-mgmtd"
    beegfs_required_packages:
      - "beegfs-mgmtd_{{ beegfs_version }}_*.deb"
      - "beegfs-utils_{{ beegfs_version }}_*.deb"
    beegfs_verify_command: "beegfs-mgmtd --version"
  tags:
    - beegfs
    - beegfs-mgmt
    - install

- name: Create BeeGFS management storage directory
  ansible.builtin.file:
    path: "{{ beegfs_mgmt_storage_directory }}"
    state: directory
    owner: root
    group: root
    mode: '0755'
  tags:
    - beegfs
    - beegfs-mgmt
    - directories

- name: Create BeeGFS management log directory
  ansible.builtin.file:
    path: "{{ beegfs_mgmt_log_directory }}"
    state: directory
    owner: root
    group: root
    mode: '0755'
  tags:
    - beegfs
    - beegfs-mgmt
    - directories
