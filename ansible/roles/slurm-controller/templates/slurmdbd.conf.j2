# SLURM Database Daemon (slurmdbd) Configuration
# Generated by Ansible for HPC SLURM deployment
# Task 017: Configure SLURM Job Accounting

#=============================================================================
# Database Configuration
#=============================================================================

# Storage type for accounting data
StorageType=accounting_storage/mysql

# Database host
StorageHost={{ slurm_database_host | default('localhost') }}

# Database port
StoragePort={{ slurm_database_port | default(3306) }}

# Database name
StorageLoc={{ slurm_database_name | default('slurm_acct_db') }}

# Database user
StorageUser={{ slurm_database_user | default('slurm') }}

# Database password
StoragePass={{ slurm_database_password | default('slurm') }}

#=============================================================================
# Service Configuration
#=============================================================================

# SLURM database daemon hostname
DbdHost={{ slurm_accounting_storage_host | default('localhost') }}

# SLURM database daemon port
DbdPort={{ slurm_accounting_storage_port | default(6819) }}

# SLURM database daemon address (bind address)
DbdAddr={{ slurm_accounting_storage_host | default('localhost') }}

# SLURM database daemon log file
LogFile={{ slurm_accounting_log_file | default('/var/log/slurm/slurmdbd.log') }}

# SLURM database daemon user
SlurmUser={{ slurm_user | default('slurm') }}

#=============================================================================
# Authentication and Security
#=============================================================================

# Authentication type
AuthType={{ slurm_auth_type | default('auth/munge') }}

#=============================================================================
# Logging and Debugging
#=============================================================================

# Debug level (0=none, 1=error, 2=warn, 3=info, 4=debug)
DebugLevel={{ slurm_accounting_debug_level | default('3') }}

# Debug flags
DebugFlags={{ slurm_accounting_debug_flags | default('DB_ARCHIVE,DB_ASSOC') }}

#=============================================================================
# Performance and Reliability
#=============================================================================

# Archive data older than this many days
ArchiveEvents={{ slurm_accounting_archive_events | default('yes') }}

# Archive jobs older than this many days
ArchiveJobs={{ slurm_accounting_archive_jobs | default('yes') }}

# Archive steps older than this many days
ArchiveSteps={{ slurm_accounting_archive_steps | default('yes') }}

# Archive usage older than this many days
ArchiveUsage={{ slurm_accounting_archive_usage | default('yes') }}

# Archive purge after this many days
PurgeEventAfter={{ slurm_accounting_purge_event_after | default('12') }}

# Purge job after this many days
PurgeJobAfter={{ slurm_accounting_purge_job_after | default('12') }}

# Purge step after this many days
PurgeStepAfter={{ slurm_accounting_purge_step_after | default('12') }}

# Purge usage after this many days
PurgeUsageAfter={{ slurm_accounting_purge_usage_after | default('12') }}

#=============================================================================
# Connection and Timeout Settings
#=============================================================================

# Message timeout
MessageTimeout={{ slurm_message_timeout | default('10') }}

# TCP timeout
TCPTimeout={{ slurm_tcp_timeout | default('2') }}

#=============================================================================
# Job Accounting Configuration
#=============================================================================

# Track job completion
TrackWCKey={{ slurm_accounting_track_wckey | default('yes') }}
