# Container Registry Configuration
# Generated by Ansible - DO NOT EDIT MANUALLY
# Cluster: {{ cluster_name | default('hpc-cluster') }}
# Generated: {{ ansible_date_time.iso8601 }}

---
version: "1.0"

registry:
  base_path: {{ container_registry_base_path }}
  owner: {{ container_registry_owner }}
  group: {{ container_registry_group }}
  mode: {{ container_registry_dir_mode }}

directories:
  ml_frameworks: {{ container_registry_base_path }}/ml-frameworks
  custom_images: {{ container_registry_base_path }}/custom-images
  base_images: {{ container_registry_base_path }}/base-images
  metadata: {{ container_registry_base_path }}/.registry

synchronization:
  enabled: {{ container_registry_sync_enabled | bool | lower }}
  method: {{ container_registry_sync_method }}
{% if groups['compute'] is defined %}
  compute_nodes:
{% for node in groups['compute'] %}
    - {{ node }}
{% endfor %}
{% endif %}

container_runtime:
  type: {{ container_runtime }}
  cache_dir: /var/lib/{{ container_runtime }}/cache
  temp_dir: /tmp/{{ container_runtime }}

slurm_integration:
  enabled: {{ container_registry_slurm_integration | bool | lower }}
  conf_dir: {{ container_registry_slurm_conf_dir }}
  plugin_dir: {{ container_registry_slurm_conf_dir }}/plugstack.conf.d

catalog:
  file: {{ container_registry_catalog_file }}
  auto_update: true
  track_usage: true

access_control:
  read_groups:
    - {{ container_registry_group }}
  write_groups:
    - root
  execute_groups:
    - {{ container_registry_group }}

metadata:
  cluster_name: {{ cluster_name | default('hpc-cluster') }}
  deployment_date: {{ ansible_date_time.iso8601 }}
  ansible_version: {{ ansible_version.full }}
  managed_by: ansible
