# BeeGFS Storage Service - Installation Tasks
# Installs from pre-built packages only (no source build)
# Now uses beegfs-common role for shared package installation logic

- name: Install BeeGFS storage service packages via common role
  ansible.builtin.import_role:
    name: beegfs-common
    tasks_from: install-packages
  vars:
    beegfs_service_type: "storage"
    beegfs_binary_check_path: "/usr/bin/beegfs-storage"
    beegfs_required_packages:
      - "beegfs-storage_{{ beegfs_version }}_*.deb"
      - "beegfs-utils_{{ beegfs_version }}_*.deb"
    beegfs_verify_command: "beegfs-storage --version"
  tags:
    - beegfs
    - beegfs-storage
    - install

- name: Create BeeGFS storage directory
  ansible.builtin.file:
    path: "{{ beegfs_storage_directory }}"
    state: directory
    owner: root
    group: root
    mode: '0755'
  tags:
    - beegfs
    - beegfs-storage
    - directories

- name: Create BeeGFS storage log directory
  ansible.builtin.file:
    path: "{{ beegfs_storage_log_directory }}"
    state: directory
    owner: root
    group: root
    mode: '0755'
  tags:
    - beegfs
    - beegfs-storage
    - directories
