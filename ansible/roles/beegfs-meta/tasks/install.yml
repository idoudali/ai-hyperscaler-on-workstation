# BeeGFS Metadata Service - Installation Tasks
# Installs from pre-built packages only (no source build)
# Now uses beegfs-common role for shared package installation logic

- name: Install BeeGFS metadata service packages via common role
  ansible.builtin.import_role:
    name: beegfs-common
    tasks_from: install-packages
  vars:
    beegfs_service_type: "meta"
    beegfs_binary_check_path: "/usr/bin/beegfs-meta"
    beegfs_required_packages:
      - "beegfs-meta_{{ beegfs_version }}_*.deb"
      - "beegfs-utils_{{ beegfs_version }}_*.deb"
    beegfs_verify_command: "beegfs-meta --version"
  tags:
    - beegfs
    - beegfs-meta
    - install

- name: Create BeeGFS metadata storage directory
  ansible.builtin.file:
    path: "{{ beegfs_meta_storage_directory }}"
    state: directory
    owner: root
    group: root
    mode: '0755'
  tags:
    - beegfs
    - beegfs-meta
    - directories

- name: Create BeeGFS metadata log directory
  ansible.builtin.file:
    path: "{{ beegfs_meta_log_directory }}"
    state: directory
    owner: root
    group: root
    mode: '0755'
  tags:
    - beegfs
    - beegfs-meta
    - directories
